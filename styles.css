/* =========================================================
   styles.css - FINAL (UI fix)
========================================================= */

:root{
  --bg:#f4f6fb;
  --card:#ffffff;
  --text:#111827;
  --muted:#6b7280;
  --line:#e5e7eb;
  --pill:#eef2ff;
  --pill-text:#3b5cff;
  --primary:#6c4cf7;
  --primary-2:#8b5cf6;
  --danger:#ef4444;
  --shadow: 0 8px 24px rgba(0,0,0,.08);
  --radius: 16px;
}

*{ box-sizing:border-box; }

body{
  margin:0;
  font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", Arial, sans-serif;
  background: var(--bg);
  color: var(--text);
}

a{ color:inherit; text-decoration:none; }

.card{
  background: var(--card);
  border: 1px solid var(--line);
  border-radius: var(--radius);
  box-shadow: 0 1px 0 rgba(0,0,0,.02);
}

.app-header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:16px;
  padding:16px 18px;
  position:sticky;
  top:0;
  z-index:10;
  background: rgba(244,246,251,.9);
  backdrop-filter: blur(8px);
  border-bottom: 1px solid rgba(229,231,235,.8);
}

.header-left h1{
  font-size:18px;
  margin:0 0 4px;
  letter-spacing:.2px;
}
.header-left .sub{
  font-size:12px;
  color: var(--muted);
}
.header-status{
  font-size:12px;
  color: var(--muted);
}

.page-body{
  max-width: 1400px;
  margin: 16px auto 60px;
  padding: 0 14px;
  display:flex;
  flex-direction:column;
  gap:14px;
}

/* =========================
   Metrics Bar
========================= */
.metrics-bar{
  padding: 14px;
}

.metrics-bar-head{
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap:10px;
  margin-bottom:10px;
}

.metrics-bar-title{
  font-weight:700;
  font-size:14px;
}
.metrics-bar-help{
  margin-top:4px;
  font-size:12px;
  color: var(--muted);
}

.metrics-actions{
  display:flex;
  gap:8px;
}
.metrics-collapse{
  border:1px solid var(--line);
  background:#fff;
  border-radius:12px;
  padding:8px 10px;
  cursor:pointer;
  display:flex;
  gap:8px;
  align-items:center;
  font-size:12px;
}
.metrics-collapse .icon{ font-size:12px; opacity:.7; }

.metrics-row{
  margin-top:12px;
  display:grid;
  grid-template-columns: repeat(5, minmax(0, 1fr));
  gap:12px;
}

.metrics-zone{
  border:1px dashed rgba(107,114,128,.35);
  background: rgba(249,250,251,.7);
  border-radius:14px;
  padding:10px;
  min-height:108px;
}

.metrics-zone-title{
  font-size:12px;
  color: var(--muted);
  margin-bottom:8px;
  font-weight:600;
}

.metrics-zone-list{
  display:flex;
  flex-wrap:wrap;
  gap:8px;
}

.metric-pill{
  background: var(--pill);
  color: var(--pill-text);
  padding:7px 10px;
  border-radius: 999px;
  font-size:12px;
  border:1px solid rgba(59,92,255,.15);
  cursor:grab;
  user-select:none;
}

.metrics-bar-foot{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  margin-top:12px;
}
.metrics-bar-foot button{
  border:1px solid var(--line);
  background:#fff;
  padding:9px 12px;
  border-radius:12px;
  cursor:pointer;
  font-size:12px;
}
.metrics-bar-foot button:hover{
  border-color: rgba(108,76,247,.35);
}

/* collapsed */
.metrics-bar.is-collapsed .metrics-row,
.metrics-bar.is-collapsed .metrics-bar-foot{
  display:none;
}

/* =========================
   Catalog
========================= */
.asin-catalog{
  padding: 14px;
}
.catalog-head{
  display:flex;
  justify-content:space-between;
  align-items:baseline;
  gap:12px;
  margin-bottom:10px;
}
.catalog-title{
  font-weight:700;
  font-size:14px;
}
.catalog-note{
  font-size:12px;
  color: var(--muted);
}

.asin-grid{
  display:grid;
  grid-template-columns: repeat(8, minmax(0,1fr));
  gap:10px;
}
.asin-item{
  border:1px solid var(--line);
  border-radius:14px;
  padding:10px;
  background:#fff;
  cursor:pointer;
  transition:.12s;
  display:flex;
  flex-direction:column;
  gap:6px;
}
.asin-item:hover{
  transform: translateY(-1px);
  border-color: rgba(108,76,247,.3);
  box-shadow: 0 8px 18px rgba(17,24,39,.06);
}
.asin-item .asin{
  font-weight:700;
  font-size:12px;
}
.asin-item .name{
  font-size:12px;
  color: var(--muted);
  line-height:1.35;
  min-height: 32px;
}

/* =========================
   Cart Summary
========================= */
.cart-summary{
  padding: 14px;
}
.cart-title{
  font-weight:700;
  font-size:14px;
  margin-bottom:10px;
}
.cart-grid{
  display:grid;
  grid-template-columns: repeat(5, minmax(0,1fr));
  gap:10px;
}
.cart-grid > div{
  border:1px solid var(--line);
  border-radius:14px;
  padding:10px;
  background: rgba(249,250,251,.65);
}
.cart-grid span{
  display:block;
  font-size:12px;
  color: var(--muted);
  margin-bottom:4px;
}
.cart-grid b{
  font-size:14px;
}

/* =========================
   Items (cards)
========================= */
.items-stack{
  display:flex;
  flex-direction:column;
  gap:14px;
}

.empty{
  padding: 22px;
  text-align:center;
  color: var(--muted);
  font-size:13px;
}

/* Card Layout */
.item-card{
  padding: 14px;
  position:relative;
}

.item-topline{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  margin-bottom:10px;
}
.item-topline .asin-title{
  font-weight:800;
  font-size:12px;
  color:#111;
}
.item-topline .btns{
  display:flex;
  gap:8px;
}
.item-topline button{
  border:1px solid var(--line);
  background:#fff;
  border-radius:999px;
  padding:7px 10px;
  cursor:pointer;
  font-size:12px;
}
.item-topline button:hover{
  border-color: rgba(108,76,247,.35);
}

.item-grid{
  display:grid;
  grid-template-columns: 360px 280px 1fr 260px;
  gap:12px;
  align-items:start;
}

/* Left box */
.left-box{
  display:flex;
  flex-direction:column;
  gap:10px;
}
.img-box{
  border:1px solid var(--line);
  border-radius:16px;
  padding:10px;
  background:#fff;
}
.img-box img{
  width:100%;
  height:220px;
  object-fit:contain;
  display:block;
  border-radius:12px;
  background: #fafafa;
  border:1px solid rgba(229,231,235,.6);
}

.cart-box{
  border:1px solid var(--line);
  border-radius:16px;
  padding:12px;
  background:#fff;
}
.cart-box .field{
  margin-bottom:10px;
}
.cart-box label{
  display:block;
  font-size:12px;
  color: var(--muted);
  margin-bottom:6px;
}
.cart-box input, .cart-box select{
  width:100%;
  height:38px;
  border-radius:12px;
  border:1px solid var(--line);
  padding:0 10px;
  font-weight:700;
}
.cart-btn{
  width:100%;
  border:none;
  height:42px;
  border-radius:999px;
  background: var(--primary);
  color:#fff;
  font-weight:800;
  cursor:pointer;
}
.cart-btn:hover{
  background: var(--primary-2);
}

/* Info box */
.info-box{
  border:1px solid var(--line);
  border-radius:16px;
  padding:12px;
  background:#fff;
}
.info-title{
  font-size:14px;
  font-weight:800;
  margin:0 0 10px;
}
.info-grid{
  display:grid;
  grid-template-columns: 120px 1fr;
  gap:8px 10px;
  font-size:12px;
}
.info-grid .k{
  color: var(--muted);
}
.info-grid .v{
  font-weight:700;
}
.warning-row{
  grid-column: 1 / -1;
  display:flex;
  flex-wrap:wrap;
  gap:8px;
}
.badge{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  padding:6px 10px;
  border-radius:999px;
  font-weight:800;
  font-size:12px;
  color:#fff;
}
.badge.red{ background: #ef4444; }
.badge.purple{ background: #7c3aed; }
.badge.orange{ background: #f97316; }

/* Center */
.center-box{
  border:1px solid var(--line);
  border-radius:16px;
  padding:12px;
  background:#fff;
}
.center-head{
  font-weight:800;
  font-size:13px;
  margin-bottom:10px;
}
.center-list{
  display:flex;
  flex-direction:column;
  gap:8px;
}
.metric-row{
  display:flex;
  justify-content:space-between;
  gap:10px;
  border:1px solid rgba(229,231,235,.75);
  border-radius:12px;
  padding:9px 10px;
  background: rgba(249,250,251,.6);
}
.metric-row .label{
  font-size:12px;
  color: var(--muted);
  min-width: 120px;
}
.metric-row .value{
  font-size:12px;
  font-weight:800;
}

/* Graph */
.graph-box{
  border:1px solid var(--line);
  border-radius:16px;
  padding:12px;
  background:#fff;
  min-height: 360px;
}
.graph-head{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:10px;
}
.graph-title{
  font-weight:800;
  font-size:13px;
}
.switch{
  display:flex;
  gap:8px;
}
.switch button{
  border:1px solid var(--line);
  background:#fff;
  padding:7px 10px;
  border-radius:999px;
  cursor:pointer;
  font-size:12px;
}
.switch button.active{
  background: rgba(108,76,247,.12);
  border-color: rgba(108,76,247,.25);
  color: var(--primary);
  font-weight:800;
}
.graph-options{
  display:flex;
  gap:12px;
  flex-wrap:wrap;
  margin-bottom:10px;
  font-size:12px;
  color: var(--muted);
}
.graph-canvas-wrap{
  border:1px solid rgba(229,231,235,.75);
  border-radius:16px;
  background:#fafafa;
  padding:10px;
}
.graph-canvas-wrap canvas{
  width:100% !important;
  height: 280px !important;
}

/* Detail table */
.detail-wrap{
  margin-top:12px;
  border:1px solid var(--line);
  border-radius:16px;
  overflow:hidden;
  background:#fff;
}
.detail-head{
  padding:10px 12px;
  background: rgba(249,250,251,.75);
  border-bottom:1px solid var(--line);
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.detail-head .t{
  font-weight:800;
  font-size:13px;
}
.detail-scroll{
  overflow:auto;
}
.detail-table{
  width:100%;
  border-collapse:collapse;
  font-size:12px;
}
.detail-table th, .detail-table td{
  padding:10px 12px;
  border-bottom:1px solid rgba(229,231,235,.75);
  white-space:nowrap;
}
.detail-table th{
  text-align:left;
  color: var(--muted);
  background: #fff;
  position:sticky;
  top:0;
}
.detail-table td{
  font-weight:800;
}

/* Responsive */
@media (max-width: 1280px){
  .asin-grid{ grid-template-columns: repeat(6, minmax(0,1fr)); }
  .item-grid{ grid-template-columns: 340px 280px 1fr; }
}
@media (max-width: 980px){
  .asin-grid{ grid-template-columns: repeat(4, minmax(0,1fr)); }
  .item-grid{ grid-template-columns: 1fr; }
  .graph-canvas-wrap canvas{ height: 240px !important; }
}
@media (max-width: 640px){
  .asin-grid{ grid-template-columns: repeat(2, minmax(0,1fr)); }
  .cart-grid{ grid-template-columns: 1fr; }
}

/* ===== 枠内で横スクロールして見れるようにする ===== */
.v,
.metric-row .value,
.metric-row .label{
  overflow-x: auto;
  overflow-y: hidden;
  white-space: nowrap;
  text-overflow: clip;
}

/* スクロールバー（任意） */
.v::-webkit-scrollbar,
.metric-row .value::-webkit-scrollbar,
.metric-row .label::-webkit-scrollbar{
  height: 6px;
}
/* =========================
   Page Tabs (header)
========================= */
.header-right{
  display:flex;
  align-items:center;
  gap:12px;
}

.page-tabs{
  display:flex;
  gap:8px;
  align-items:center;
}

.page-tabs .tab{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  padding:8px 12px;
  border-radius:999px;
  border:1px solid var(--line);
  background:#fff;
  font-size:12px;
  font-weight:700;
  color:var(--text);
  opacity:.85;
}

.page-tabs .tab.active{
  border-color: rgba(91,92,255,.35);
  background: rgba(91,92,255,.10);
  opacity:1;
}

/* =========================
   Layout2: card内の配置だけ変更（HTMLは同じ）
   ※ createProductCard の item-grid 内の要素順は同じでOK
========================= */
body.layout2 .item-grid{
  /* ここを好みで調整OK（例：グラフを右端に寄せる） */
  grid-template-columns: 360px 280px 260px 1fr;
}
